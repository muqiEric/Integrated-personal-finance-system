{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array-buffer.constructor.js\";\nimport \"core-js/modules/es.array-buffer.slice.js\";\nimport \"core-js/modules/es.data-view.js\";\nimport \"core-js/modules/es.array-buffer.detached.js\";\nimport \"core-js/modules/es.array-buffer.transfer.js\";\nimport \"core-js/modules/es.array-buffer.transfer-to-fixed-length.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.typed-array.uint8-array.js\";\nimport \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.copy-within.js\";\nimport \"core-js/modules/es.typed-array.every.js\";\nimport \"core-js/modules/es.typed-array.fill.js\";\nimport \"core-js/modules/es.typed-array.filter.js\";\nimport \"core-js/modules/es.typed-array.find.js\";\nimport \"core-js/modules/es.typed-array.find-index.js\";\nimport \"core-js/modules/es.typed-array.find-last.js\";\nimport \"core-js/modules/es.typed-array.find-last-index.js\";\nimport \"core-js/modules/es.typed-array.for-each.js\";\nimport \"core-js/modules/es.typed-array.includes.js\";\nimport \"core-js/modules/es.typed-array.index-of.js\";\nimport \"core-js/modules/es.typed-array.iterator.js\";\nimport \"core-js/modules/es.typed-array.join.js\";\nimport \"core-js/modules/es.typed-array.last-index-of.js\";\nimport \"core-js/modules/es.typed-array.map.js\";\nimport \"core-js/modules/es.typed-array.reduce.js\";\nimport \"core-js/modules/es.typed-array.reduce-right.js\";\nimport \"core-js/modules/es.typed-array.reverse.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/es.typed-array.slice.js\";\nimport \"core-js/modules/es.typed-array.some.js\";\nimport \"core-js/modules/es.typed-array.sort.js\";\nimport \"core-js/modules/es.typed-array.subarray.js\";\nimport \"core-js/modules/es.typed-array.to-locale-string.js\";\nimport \"core-js/modules/es.typed-array.to-reversed.js\";\nimport \"core-js/modules/es.typed-array.to-sorted.js\";\nimport \"core-js/modules/es.typed-array.to-string.js\";\nimport \"core-js/modules/es.typed-array.with.js\";\nimport * as XLSX from \"xlsx\";\nexport default {\n  data: function data() {\n    return {\n      selectedFile: null,\n      // 保存选择的文件\n      dragging: false,\n      // 是否正在拖拽文件\n      transactions: [\n      // 模拟的交易数据（可以从后台 API 获取）\n      {\n        id: 1,\n        trans_time: \"2023-11-21\",\n        trans_type: \"收入\",\n        amount: 5000,\n        note: \"工资\"\n      }, {\n        id: 2,\n        trans_time: \"2023-11-20\",\n        trans_type: \"支出\",\n        amount: -200,\n        note: \"家庭采购\"\n      }]\n    };\n  },\n  methods: {\n    dragEnter: function dragEnter() {\n      this.dragging = true;\n    },\n    dragLeave: function dragLeave() {\n      this.dragging = false;\n    },\n    handleFileDrop: function handleFileDrop(event) {\n      this.dragging = false;\n      var file = event.dataTransfer.files[0];\n      if (file && (file.type === \"application/vnd.ms-excel\" || file.type.includes(\"spreadsheet\"))) {\n        this.selectedFile = file;\n        this.$refs.fileInput.value = \"\";\n      } else {\n        alert(\"请上传有效的 Excel 文件！\");\n      }\n    },\n    handleFileSelect: function handleFileSelect(event) {\n      var file = event.target.files[0];\n      if (file && (file.type === \"application/vnd.ms-excel\" || file.type.includes(\"spreadsheet\"))) {\n        this.selectedFile = file;\n      } else {\n        alert(\"请上传有效的 Excel 文件！\");\n      }\n    },\n    confirmUpload: function confirmUpload() {\n      if (!this.selectedFile) {\n        alert(\"请先选择文件！\");\n        return;\n      }\n      var reader = new FileReader();\n      reader.onload = function (e) {\n        var data = new Uint8Array(e.target.result);\n        var workbook = XLSX.read(data, {\n          type: \"array\"\n        });\n        var firstSheetName = workbook.SheetNames[0];\n        var worksheet = workbook.Sheets[firstSheetName];\n        var jsonData = XLSX.utils.sheet_to_json(worksheet);\n        console.log(\"解析的 Excel 数据：\", jsonData);\n        alert(\"文件上传成功！数据已解析到控制台。\");\n      };\n      reader.readAsArrayBuffer(this.selectedFile);\n    },\n    exportReport: function exportReport() {\n      var worksheet = XLSX.utils.json_to_sheet(this.transactions);\n      var workbook = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(workbook, worksheet, \"收支明细报告\");\n      XLSX.writeFile(workbook, \"收支明细报告.xlsx\");\n      alert(\"收支明细报告已导出！\");\n    }\n  }\n};","map":{"version":3,"names":["XLSX","data","selectedFile","dragging","transactions","id","trans_time","trans_type","amount","note","methods","dragEnter","dragLeave","handleFileDrop","event","file","dataTransfer","files","type","includes","$refs","fileInput","value","alert","handleFileSelect","target","confirmUpload","reader","FileReader","onload","e","Uint8Array","result","workbook","read","firstSheetName","SheetNames","worksheet","Sheets","jsonData","utils","sheet_to_json","console","log","readAsArrayBuffer","exportReport","json_to_sheet","book_new","book_append_sheet","writeFile"],"sources":["C:\\Users\\20915\\IdeaProjects\\financialmanagement\\src\\views\\UploadPage.vue"],"sourcesContent":["<template>\r\n  <div class=\"upload-page\">\r\n    <!-- 装饰栏 -->\r\n    <header class=\"header-bar\">\r\n      <img src=\"../assets/86db5a7dc000fc26bb2e0caeaabeea3f.jpg\" alt=\"装饰图片\" class=\"header-image\" />\r\n      <h1 class=\"header-title\">财务管理系统</h1>\r\n    </header>\r\n\r\n    <h1>用户上传页面</h1>\r\n\r\n    <!-- 拖拽上传区域 -->\r\n    <div\r\n        class=\"upload-box\"\r\n        @dragover.prevent\r\n        @drop=\"handleFileDrop\"\r\n        @dragleave=\"dragLeave\"\r\n        @dragenter=\"dragEnter\"\r\n    >\r\n      <p v-if=\"!dragging\">拖入 Excel 文件到此处，或点击选择文件</p>\r\n      <p v-else>释放鼠标上传文件</p>\r\n      <input type=\"file\" ref=\"fileInput\" accept=\".xls,.xlsx\" @change=\"handleFileSelect\" hidden />\r\n    </div>\r\n\r\n    <!-- 上传按钮 -->\r\n    <button @click=\"confirmUpload\" :disabled=\"!selectedFile\" class=\"upload-button\">\r\n      确认上传\r\n    </button>\r\n\r\n    <!-- 导出按钮 -->\r\n    <button @click=\"exportReport\" class=\"export-button\">\r\n      导出收支明细报告\r\n    </button>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as XLSX from \"xlsx\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      selectedFile: null, // 保存选择的文件\r\n      dragging: false, // 是否正在拖拽文件\r\n      transactions: [\r\n        // 模拟的交易数据（可以从后台 API 获取）\r\n        { id: 1, trans_time: \"2023-11-21\", trans_type: \"收入\", amount: 5000, note: \"工资\" },\r\n        { id: 2, trans_time: \"2023-11-20\", trans_type: \"支出\", amount: -200, note: \"家庭采购\" },\r\n      ],\r\n    };\r\n  },\r\n  methods: {\r\n    dragEnter() {\r\n      this.dragging = true;\r\n    },\r\n\r\n    dragLeave() {\r\n      this.dragging = false;\r\n    },\r\n\r\n    handleFileDrop(event) {\r\n      this.dragging = false;\r\n      const file = event.dataTransfer.files[0];\r\n      if (file && (file.type === \"application/vnd.ms-excel\" || file.type.includes(\"spreadsheet\"))) {\r\n        this.selectedFile = file;\r\n        this.$refs.fileInput.value = \"\";\r\n      } else {\r\n        alert(\"请上传有效的 Excel 文件！\");\r\n      }\r\n    },\r\n\r\n    handleFileSelect(event) {\r\n      const file = event.target.files[0];\r\n      if (file && (file.type === \"application/vnd.ms-excel\" || file.type.includes(\"spreadsheet\"))) {\r\n        this.selectedFile = file;\r\n      } else {\r\n        alert(\"请上传有效的 Excel 文件！\");\r\n      }\r\n    },\r\n\r\n    confirmUpload() {\r\n      if (!this.selectedFile) {\r\n        alert(\"请先选择文件！\");\r\n        return;\r\n      }\r\n\r\n      const reader = new FileReader();\r\n      reader.onload = (e) => {\r\n        const data = new Uint8Array(e.target.result);\r\n        const workbook = XLSX.read(data, { type: \"array\" });\r\n        const firstSheetName = workbook.SheetNames[0];\r\n        const worksheet = workbook.Sheets[firstSheetName];\r\n        const jsonData = XLSX.utils.sheet_to_json(worksheet);\r\n        console.log(\"解析的 Excel 数据：\", jsonData);\r\n        alert(\"文件上传成功！数据已解析到控制台。\");\r\n      };\r\n      reader.readAsArrayBuffer(this.selectedFile);\r\n    },\r\n\r\n    exportReport() {\r\n      const worksheet = XLSX.utils.json_to_sheet(this.transactions);\r\n      const workbook = XLSX.utils.book_new();\r\n      XLSX.utils.book_append_sheet(workbook, worksheet, \"收支明细报告\");\r\n      XLSX.writeFile(workbook, \"收支明细报告.xlsx\");\r\n      alert(\"收支明细报告已导出！\");\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* 页面整体样式 */\r\n.upload-page {\r\n  font-family: Arial, sans-serif;\r\n  padding: 20px;\r\n  text-align: center;\r\n  color: #333;\r\n}\r\n\r\n/* 顶部装饰栏样式 */\r\n.header-bar {\r\n  background-color: #f8f9fa;\r\n  padding: 10px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-bottom: 2px solid #ddd;\r\n}\r\n\r\n.header-image {\r\n  height: 50px;\r\n  margin-right: 20px;\r\n}\r\n\r\n.header-title {\r\n  font-size: 24px;\r\n  color: #333;\r\n}\r\n\r\n/* 拖拽上传区域样式 */\r\n.upload-box {\r\n  border: 2px dashed #007bff;\r\n  border-radius: 8px;\r\n  padding: 40px;\r\n  margin: 20px auto;\r\n  width: 50%;\r\n  text-align: center;\r\n  color: #555;\r\n  cursor: pointer;\r\n  transition: border-color 0.3s ease;\r\n}\r\n\r\n.upload-box:hover {\r\n  border-color: #0056b3;\r\n}\r\n\r\n.upload-box p {\r\n  margin: 0;\r\n  font-size: 16px;\r\n}\r\n\r\n/* 按钮样式 */\r\n.upload-button,\r\n.export-button {\r\n  margin: 20px;\r\n  padding: 10px 20px;\r\n  font-size: 16px;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  color: white;\r\n  background-color: #007bff;\r\n}\r\n\r\n.upload-button:disabled {\r\n  background-color: #ccc;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.upload-button:hover:not(:disabled),\r\n.export-button:hover {\r\n  background-color: #0056b3;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}